# Training configuration for mesh super-resolution

data:
  dataset_path: '/lustre/orion/csc143/proj-shared/gongq/frontier/VERTEX/dataset'
  source_resolution: 'coarse'   # Options: coarse, medium, fine
  target_resolution: 'fine'      # Options: medium, fine, finest
  use_cache: true                # Cache interpolated data (recommended!)
  cache_dir: './cache'           # Directory for cache files

model:
  type: 'gnn'                    # Options: gnn, encoder_decoder, mlp
  hidden_channels: 128
  num_layers: 4
  num_levels: 3                  # For encoder_decoder
  dropout: 0.1
  k_neighbors: 8                 # Number of neighbors for graph construction

training:
  # Optional: device selection. Examples: 'cpu', 'cuda', 'cuda:0', 'cuda:1'.
  # If omitted/null: auto-select (cuda:0 if available else cpu).
  device: null
  batch_size: 1                  # Usually 1 for graph data
  learning_rate: 0.001
  weight_decay: 0.00001
  num_epochs: 100
  save_every: 10
  output_dir: './outputs'

  # Optional (recommended for small interpolation error regimes):
  # Predict corrections instead of absolute fields: residual = fine - interpolated.
  residual_learning: false
  # Normalize residual targets by dataset mean/std; stats saved into checkpoints.
  residual_normalization: false
  residual_norm_eps: 1.0e-8
  # Optional graph-smoothness penalty on predicted correction (graph models only, residual_learning only).
  smoothness_lambda: 0.0

  # -----------------------------
  # Data loss configuration
  # -----------------------------
  # Choose which loss is optimized during training:
  #   - 'mse'   (weighted L2)
  #   - 'huber' (weighted SmoothL1)
  data_loss_type: 'mse'
  # Huber transition point (beta). Only used when data_loss_type='huber'.
  data_loss_huber_delta: 1.0
  # Per-output-channel weights. Set to null to disable weighting.
  # IMPORTANT: length must match the model output channels.
  # Examples:
  #   - 4 outputs (vx, vy, p, T): [1.0, 1.0, 5.0, 1.0]
  #   - 3 outputs (vx, vy, p):   [1.0, 1.0, 5.0]
  data_loss_channel_weights: null

# To train with different settings, modify these parameters:
# - For coarse -> finest: Change target_resolution to 'finest'
# - For larger model: Increase hidden_channels and num_layers
# - For faster training: Reduce num_epochs
